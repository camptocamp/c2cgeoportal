
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Functionalities &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="functionalities">
<h1>Functionalities<a class="headerlink" href="#functionalities" title="Permalink to this headline">¶</a></h1>
<p>c2cgeoportal provides the concept of <em>functionality</em> that can be used to customize
the application according to the user’s permissions.</p>
<p>A functionality may be associated to users through different ways:</p>
<ol class="arabic simple">
<li>Functionalities for anonymous users are defined through the
<code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code> variable in the <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> configuration file.</li>
<li>Functionalities for authenticated users are defined through the
<code class="docutils literal notranslate"><span class="pre">functionalities:registered</span></code> variable in the <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> configuration file.</li>
<li>Functionalities for specific roles are defined in the database through the administration interface.</li>
<li>Functionalities for specific users are defined in the database through the administration interface.</li>
</ol>
<p>Each level overrides the previous ones in the order indicated above.
For example, if the user is authenticated and has associated functionalities in
the <code class="docutils literal notranslate"><span class="pre">user</span></code> database table, then the <code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code> and
<code class="docutils literal notranslate"><span class="pre">functionalities:registered</span></code> configuration variables, as well as any
functionality associated with his/her role, will be ignored.</p>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> file includes variables for managing <em>functionalities</em>.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">admin_interface</span></code>/<code class="docutils literal notranslate"><span class="pre">available_functionalities</span></code></dt>
<dd><p class="first">List of functionality types that should be available in the
administration interface (and added to the <code class="docutils literal notranslate"><span class="pre">functionality</span></code> table in the
database).</p>
<p>For example:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">admin_interface</span><span class="p">:</span>
    <span class="n">available_functionalities</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">default_basemap</span>
    <span class="o">-</span> <span class="n">print_template</span>
    <span class="o">-</span> <span class="n">mapserver_substitution</span>
</pre></div>
</div>
<p>The following syntax is also accepted:</p>
<div class="code yaml last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">admin_interface</span><span class="p">:</span>
    <span class="n">available_functionalities</span><span class="p">:</span> <span class="p">[</span><span class="n">default_basemap</span><span class="p">,</span> <span class="n">print_template</span><span class="p">,</span> <span class="n">mapserver_substitution</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code></dt>
<dd><p class="first">Functionalities accessible to anonymous users. This is a list of
key/value pairs, whose values are either arrays or scalars.</p>
<p>For example:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="n">print_template</span><span class="p">:</span>
        <span class="o">-</span> <span class="mi">1</span> <span class="n">A4</span> <span class="n">portrait</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="n">A3</span> <span class="n">landscape</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="n">plan</span>
</pre></div>
</div>
<p class="last">In this example, anonymous users can print maps using the <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">A4</span> <span class="pre">portrait</span></code>
and <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">A3</span> <span class="pre">landscape</span></code> layouts only. Their default base layer is the
<code class="docutils literal notranslate"><span class="pre">plan</span></code> layer.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">functionalities:registered</span></code></dt>
<dd>Functionalities accessible to any authenticated user. This is a list of
key/value pairs, of the same form as for <code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">functionalities:available_in_templates</span></code></dt>
<dd><p class="first">Functionalities that are made available to Mako templates (e.g.
<code class="docutils literal notranslate"><span class="pre">viewer.js</span></code>) through the <code class="docutils literal notranslate"><span class="pre">functionality</span></code> template variable.</p>
<p>For example with:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">available_in_templates</span><span class="p">:</span>
    <span class="o">-</span> <span class="o">&lt;</span><span class="n">functionality_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p class="last">if a user is associated to, say,
<code class="docutils literal notranslate"><span class="pre">&lt;functionality_name&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">value1</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;functionality_name&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">value2</span></code>,
then the <code class="docutils literal notranslate"><span class="pre">functionality</span></code> template variable will be set to a dict with one
key/value pair: <code class="docutils literal notranslate"><span class="pre">&quot;&lt;functionality_name&gt;&quot;:</span> <span class="pre">[&quot;value1&quot;,&quot;value2&quot;]</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="usage-in-templates">
<h2>Usage in Templates<a class="headerlink" href="#usage-in-templates" title="Permalink to this headline">¶</a></h2>
<p>As explained in the configuration section above,
a functionality can be used in the Mako templates as long as it has been
enabled using the <code class="docutils literal notranslate"><span class="pre">functionalities:available_in_templates</span></code> parameter in the
<code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> configuration file.</p>
<p>Functionalities may be used in templates for various purposes. The examples
below explain how to set the default basemap and how to limit access to some
plugins according to the user’s permissions.</p>
<div class="section" id="example-of-the-default-basemap-functionality">
<h3>Example of the default_basemap Functionality<a class="headerlink" href="#example-of-the-default-basemap-functionality" title="Permalink to this headline">¶</a></h3>
<p>Using functionalities, you can set the default basemap that will be
displayed when a user loads the application depending on whether he/she is
anonymous, authenticated or has some specific role.</p>
<p>First, make sure that <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> is made available in the templates
using the <code class="docutils literal notranslate"><span class="pre">functionalities:available_in_templates</span></code> parameter in the
<code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> configuration file:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">available_in_templates</span><span class="p">:</span> <span class="p">[</span><span class="n">default_basemap</span><span class="p">]</span>
</pre></div>
</div>
<p>Then indicate (still in <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code>) what default basemap should be used
for anonymous users:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="c1"># some other configs...</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">some_basemap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Optionally, you may also indicate what basemap to use for authenticated users
(if omitted, the anonymous <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> value will be used):</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="c1"># ...</span>
    <span class="n">registered</span><span class="p">:</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">some_other_basemap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Finally, you may link <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> functionalities to some roles or
users in the administration interface.</p>
<p>If you are using the <code class="docutils literal notranslate"><span class="pre">cgxp_mapopacityslider</span></code> plugin, use the following configuration in your
project’s <code class="docutils literal notranslate"><span class="pre">viewer.js</span></code> template so that the <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> is provided there:</p>
<div class="code javascript highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="n">ptype</span><span class="p">:</span> <span class="s2">&quot;cgxp_mapopacityslider&quot;</span><span class="p">,</span>
    <span class="n">defaultBaseLayerRef</span><span class="p">:</span> <span class="s2">&quot;${functionality[&#39;default_basemap&#39;][0] | n}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="using-functionalities-to-configure-the-basemap-to-use-for-each-theme">
<h3>Using Functionalities to configure the basemap to use for each theme<a class="headerlink" href="#using-functionalities-to-configure-the-basemap-to-use-for-each-theme" title="Permalink to this headline">¶</a></h3>
<p>A default basemap may be automatically loaded when the user selects a given
theme.</p>
<p>Then, in the administration interface, if not available yet, define a
<code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> functionality containing the basemap reference. Edit the
theme and select the basemap to load in the <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> list. If
several <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> items are selected, only the first one will be
taken into account.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Functionalities</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#usage-in-templates">Usage in Templates</a><ul>
<li><a class="reference internal" href="#example-of-the-default-basemap-functionality">Example of the default_basemap Functionality</a></li>
<li><a class="reference internal" href="#using-functionalities-to-configure-the-basemap-to-use-for-each-theme">Using Functionalities to configure the basemap to use for each theme</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/integrator/functionality.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2019, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/integrator/functionality.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>