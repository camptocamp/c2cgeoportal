Backport of #12041 to 2.9

Error on cherry-picking: b5df8acedfc0261c710045879a3dfec57185d40f, 45aaa784e82c6b6b8b25dfe33d80ae1fc613437a, fe018d056d1907324915db44e057219614eb1c80

To continue do:
```bash
git fetch && \
  git checkout ghci/backport/12041-to-2.9 && \
  git reset --hard HEAD^ && \
  git cherry-pick b5df8acedfc0261c710045879a3dfec57185d40f 45aaa784e82c6b6b8b25dfe33d80ae1fc613437a fe018d056d1907324915db44e057219614eb1c80
git push origin ghci/backport/12041-to-2.9 --force
```