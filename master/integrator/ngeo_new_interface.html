
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Adding a new user interface &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using multiple databases" href="multiple_databases.html" />
    <link rel="prev" title="TileGeneration" href="tilegeneration.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="adding-a-new-user-interface">
<span id="integrator-ngeo-new-interface"></span><h1>Adding a new user interface<a class="headerlink" href="#adding-a-new-user-interface" title="Permalink to this headline">¶</a></h1>
<p>This section describes how to add a new user interface to be named &lt;interface&gt;
(for example, “new”) in a package named &lt;package&gt; (for example, “demo”).</p>
<div class="section" id="makefile">
<h2>Makefile<a class="headerlink" href="#makefile" title="Permalink to this headline">¶</a></h2>
<p>In your project’s makefile, add the new interface to <code class="docutils literal"><span class="pre">NGEO_INTERFACES</span></code>.
For example, to have two NGEO interfaces called “mobile” and “new”, set:</p>
<div class="code makefile highlight-default"><div class="highlight"><pre><span></span><span class="n">NGEO_INTERFACES</span> <span class="o">=</span> <span class="n">mobile</span> <span class="n">new</span>
</pre></div>
</div>
</div>
<div class="section" id="copy-files-from-template">
<h2>Copy files from template<a class="headerlink" href="#copy-files-from-template" title="Permalink to this headline">¶</a></h2>
<p>First, be sure you have all the required files from the templates; if not,
copy them as follows:</p>
<pre class="highlight"><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">mkdir &lt;package&gt;/static-ngeo</span>
<span class="prompt1">cp -r CONST_create_template/&lt;package&gt;/static-ngeo/components &lt;package&gt;/static-ngeo/</span>
<span class="prompt1">cp -r CONST_create_template/&lt;package&gt;/static-ngeo/images &lt;package&gt;/static-ngeo/</span>
<span class="prompt1">mkdir &lt;package&gt;/static-ngeo/js</span>
<span class="prompt1">cp CONST_create_template/&lt;package&gt;/static-ngeo/js/&lt;package&gt;module.js &lt;package&gt;/static-ngeo/js/</span>
<span class="prompt1">mkdir &lt;package&gt;/static-ngeo/less</span>
<span class="prompt1">cp CONST_create_template/&lt;package&gt;/static-ngeo/less/&lt;package&gt;.less &lt;package&gt;/static-ngeo/less/</span>
<span class="prompt1"><span class="c1"># Add all the new files to Git</span></span>
<span class="prompt1">git add &lt;package&gt;/static-ngeo</span>
</pre><p>Then, if you want a new mobile interface, get the default files as follows:</p>
<pre class="highlight"><span class="prompt1">cp CONST_create_template/&lt;package&gt;/templates/mobile.html &lt;package&gt;/templates/&lt;interface&gt;.html</span>
<span class="prompt1">cp CONST_create_template/&lt;package&gt;/static-ngeo/less/mobile.less &lt;package&gt;/static-ngeo/less/&lt;interface&gt;.less</span>
<span class="prompt1">cp CONST_create_template/&lt;package&gt;/static-ngeo/js/mobile.js &lt;package&gt;/static-ngeo/js/&lt;interface&gt;.js</span>
</pre><p>If you want a new desktop interface, get the default files as follows:</p>
<pre class="highlight"><span class="prompt1">cp CONST_create_template/&lt;package&gt;/templates/desktop.html &lt;package&gt;/templates/&lt;interface&gt;.html</span>
<span class="prompt1">cp CONST_create_template/&lt;package&gt;/static-ngeo/less/desktop.less &lt;package&gt;/static-ngeo/less/&lt;interface&gt;.less</span>
<span class="prompt1">cp CONST_create_template/&lt;package&gt;/static-ngeo/js/desktop.js &lt;package&gt;/static-ngeo/js/&lt;interface&gt;.js</span>
</pre></div>
<div class="section" id="edit-interface-files">
<h2>Edit interface files<a class="headerlink" href="#edit-interface-files" title="Permalink to this headline">¶</a></h2>
<p>In the file <code class="docutils literal"><span class="pre">&lt;package&gt;/static-ngeo/js/&lt;interface&gt;.js</span></code>, adapt the following lines:</p>
<div class="code js highlight-default"><div class="highlight"><pre><span></span>* This file defines the &quot;&lt;package&gt;_&lt;interface&gt;&quot; Closure namespace, which is be used as
...
goog.provide(&#39;&lt;package&gt;.&lt;Interface&gt;Controller&#39;);
goog.provide(&#39;&lt;package&gt;_&lt;interface&gt;&#39;);
...
geoportal.&lt;Interface&gt;Controller = function($scope, $injector) {
...
ol.inherits(&lt;package&gt;.&lt;Interface&gt;Controller, gmf.AbstractDesktopController);
...
geoportal.module.controller(&#39;&lt;Interface&gt;Controller&#39;, &lt;package&gt;.&lt;Interface&gt;Controller);
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">&lt;package&gt;</span></code> is the name of your package, and <code class="docutils literal"><span class="pre">&lt;interface&gt;</span></code> (desktop in the original file) is
the name of your new interface.</p>
<p>In the file <code class="docutils literal"><span class="pre">&lt;package/static-ngeo/templates/&lt;interface&gt;.html</span></code>, adapt the name of the controller and the
referenced css and js files to the new interface name:</p>
<div class="code html highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;{{mainCtrl.lang}}&quot;</span> <span class="n">ng</span><span class="o">-</span><span class="n">app</span><span class="o">=</span><span class="s2">&quot;&lt;package&gt;&quot;</span> <span class="n">ng</span><span class="o">-</span><span class="n">controller</span><span class="o">=</span><span class="s2">&quot;&lt;Interface&gt;Controller as mainCtrl&quot;</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;${request.static_url(&#39;&lt;package&gt;:static-ngeo/build/&lt;interface&gt;.css&#39;)}&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span><span class="o">&gt;</span>
<span class="o">...</span>
<span class="n">goog</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="s1">&#39;&lt;package&gt;_&lt;interface&gt;&#39;</span><span class="p">);</span>
<span class="o">...</span>
<span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;${request.static_url(&#39;&lt;package&gt;:static-ngeo/build/&lt;interface&gt;.js&#39;)}&quot;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Add the new interface files to Git:</p>
<pre class="highlight"><span class="prompt1">git add &lt;package&gt;/templates/&lt;inferface&gt;.html</span>
<span class="prompt1">git add &lt;package&gt;/templates/&lt;inferface&gt;.less</span>
<span class="prompt1">git add &lt;package&gt;/static-ngeo/js/&lt;inferface&gt;.js</span>
</pre></div>
<div class="section" id="package-file">
<h2>Package file<a class="headerlink" href="#package-file" title="Permalink to this headline">¶</a></h2>
<p>Update the interface in your <code class="docutils literal"><span class="pre">&lt;package&gt;/__init__.py</span></code> file:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">add_interface</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;&lt;interface&gt;&quot;</span><span class="p">,</span> <span class="n">INTERFACE_TYPE_NGEO</span><span class="p">)</span>
</pre></div>
</div>
<p>The used method has the following API:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">add_interface</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">interface_name</span><span class="o">=</span><span class="s2">&quot;&lt;interface&gt;&quot;</span><span class="p">,</span> <span class="n">interface_type</span><span class="o">=</span><span class="n">INTERFACE_TYPE_NGEO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal"><span class="pre">config</span></code> is the application configuration object,</p>
<p><code class="docutils literal"><span class="pre">interface_name</span></code> is the name specified in the <code class="docutils literal"><span class="pre">interface</span></code> table,
also used to create the route path,</p>
<p><code class="docutils literal"><span class="pre">interface_type</span></code> may be either <code class="docutils literal"><span class="pre">INTERFACE_TYPE_CGXP</span></code>, <code class="docutils literal"><span class="pre">INTERFACE_TYPE_NGEO</span></code> or
<code class="docutils literal"><span class="pre">INTERFACE_TYPE_NGEO_CATALOGUE</span></code>. Constants available in <code class="docutils literal"><span class="pre">c2cgeoportal</span></code>.</p>
</div>
<div class="section" id="site-specific-configuration">
<h2>Site-specific configuration<a class="headerlink" href="#site-specific-configuration" title="Permalink to this headline">¶</a></h2>
<p>After rebuilding your project and verifying that the new interface has no technical errors,
some site-specific configuration issues must be considered:</p>
<blockquote>
<div><ul class="simple">
<li>if you have V1 configuration and this has not yet been migrated to V2 configuration
on this DB instance, it must be migrated now (if it is for test purposes, clone the
DB first): run script <code class="docutils literal"><span class="pre">.build/venv/bin/themev1tov2</span></code></li>
<li>set default theme of the new interface to the desired one (set “defaultTheme”
in <code class="docutils literal"><span class="pre">&lt;interface&gt;.html</span></code>)</li>
<li>set meaningful starting zoom level and center coordinates of new interface,
in <code class="docutils literal"><span class="pre">&lt;interface&gt;.js</span></code></li>
<li>after rebuilding, to see the changes in the browser, you probably need to clear
the browser cache and your URL parameters, and maybe in addition wait some minutes
in order for the server-side to also be completely up-to-date.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>The administration interface gives access to an <code class="docutils literal"><span class="pre">interface</span></code> table that lists the
available interfaces (or pages) of the application.
The default interfaces are <code class="docutils literal"><span class="pre">desktop</span></code> and <code class="docutils literal"><span class="pre">mobile</span></code>.
Add the name of your interface to the table. This can be done using the admin interface.</p>
</div>
<div class="section" id="checker">
<h2>Checker<a class="headerlink" href="#checker" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to Enable the checker for the new interface.</p>
<p>We suggest to add only the main checker in the <code class="docutils literal"><span class="pre">defaults</span></code>. It is what is done by default.
In the <code class="docutils literal"><span class="pre">all</span></code> (<code class="docutils literal"><span class="pre">vars.checker.all</span></code>) section, check all the ngeo interfaces in standard
and debug mode:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="n">phantomjs_routes</span><span class="p">:</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">interface</span><span class="o">&gt;</span>
  <span class="n">params</span><span class="p">:</span>
    <span class="n">no_redirect</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">interface</span><span class="o">&gt;</span>
  <span class="n">param</span><span class="p">:</span>
    <span class="n">no_redirect</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
    <span class="n">debug</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
</pre></div>
</div>
<p>By default, the checker is enabled for the desktop and mobile interfaces.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Adding a new user interface</a><ul>
<li><a class="reference internal" href="#makefile">Makefile</a></li>
<li><a class="reference internal" href="#copy-files-from-template">Copy files from template</a></li>
<li><a class="reference internal" href="#edit-interface-files">Edit interface files</a></li>
<li><a class="reference internal" href="#package-file">Package file</a></li>
<li><a class="reference internal" href="#site-specific-configuration">Site-specific configuration</a></li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#checker">Checker</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Integrator Guide</a><ul>
  <li><a href="configuration.html">Configuration Guide for advanced settings</a><ul>
      <li>Previous: <a href="tilegeneration.html" title="previous chapter">TileGeneration</a></li>
      <li>Next: <a href="multiple_databases.html" title="next chapter">Using multiple databases</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/integrator/ngeo_new_interface.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2017, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/integrator/ngeo_new_interface.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>