
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Authentication &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/c2c.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="authentication">
<h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-default-policy">
<h2>The default policy<a class="headerlink" href="#the-default-policy" title="Permalink to this headline">¶</a></h2>
<p>By default, <code class="docutils literal notranslate"><span class="pre">c2cgeoportal</span></code> applications use an <em>auth ticket</em> authentication
policy (<code class="docutils literal notranslate"><span class="pre">AuthTktAuthenticationPolicy</span></code>). With this policy, the user name is
obtained from the “auth ticket” cookie set in the request.
The policy is created, and added to the application’s configuration, in the
application’s main <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.</p>
<p>In the file <code class="docutils literal notranslate"><span class="pre">.env.sample</span></code>, you can configure the policy with the following variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AUTHTKT_TIMEOUT</span>  <span class="c1"># Default to one day.</span>
<span class="n">AUTHTKT_REISSUE_TIME</span>  <span class="c1"># Default to 2h30, recommended to be 10 times smaller than AUTHTKT_TIMEOUT.</span>
<span class="n">AUTHTKT_MAXAGE</span>  <span class="c1"># Default to one day, good to have the same value as AUTHTKT_TIMEOUT.</span>
<span class="n">AUTHTKT_SECRET</span>  <span class="c1"># Should be defined</span>
<span class="n">AUTHTKT_COOKIENAME</span>
<span class="n">AUTHTKT_HTTP_ONLY</span>  <span class="c1"># Default to true.</span>
<span class="n">AUTHTKT_SECURE</span>  <span class="c1"># Default to true.</span>
<span class="n">AUTHTKT_SAMESITE</span>  <span class="c1"># Default to Lax.</span>
</pre></div>
</div>
<p>See also <a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid/en/latest/api/authentication.html#pyramid.authentication.AuthTktAuthenticationPolicy">the official documentation</a>.</p>
</div>
<div class="section" id="using-another-policy">
<h2>Using another policy<a class="headerlink" href="#using-another-policy" title="Permalink to this headline">¶</a></h2>
<p>When using <code class="docutils literal notranslate"><span class="pre">AuthTktAuthenticationPolicy</span></code>, an “auth ticket” cookie should be
set in the request for the user to be identified. In some applications, using
a custom identification mechanism may be needed instead, for instance to use SSO.
Our knowledge base has an example of how this can be achieved.</p>
</div>
<div class="section" id="user-validation">
<h2>User validation<a class="headerlink" href="#user-validation" title="Permalink to this headline">¶</a></h2>
<p>For logging in, <code class="docutils literal notranslate"><span class="pre">c2cgeoportal</span></code> validates the user credentials
(username/password) by reading the user information from the <code class="docutils literal notranslate"><span class="pre">user</span></code> database
table. If a c2cgeoportal application should work with another user information
source, like LDAP, a custom <em>client validation</em> mechanism can be set up.
Our knowledge base has an example of how this can be achieved.</p>
</div>
<div class="section" id="basic-auth">
<h2>Basic auth<a class="headerlink" href="#basic-auth" title="Permalink to this headline">¶</a></h2>
<p>To be able to access the OGC services from your desktop GIS, you should enable the basic authentication
by setting <code class="docutils literal notranslate"><span class="pre">BASICAUTH</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> in the <code class="docutils literal notranslate"><span class="pre">.env.sample</span></code> file.</p>
<p>To force the application to ask for a password, you should have the attribute <code class="docutils literal notranslate"><span class="pre">authentication_required</span></code>
in your query string.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For security reasons, basic authentication and two factor authentication should not be enabled together.</p>
</div>
</div>
<div class="section" id="two-factors-authentication">
<h2>Two factors authentication<a class="headerlink" href="#two-factors-authentication" title="Permalink to this headline">¶</a></h2>
<p>GeoMapFish support TOTP (Time-Based One-Time Password Algorithm) two factors authentication
(<a class="reference external" href="https://tools.ietf.org/html/rfc6238">RFC 6238</a>).
To enable the two factors authentication you should set the following settings:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars</span><span class="p">:</span>
  <span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">two_factor</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">two_factor_issuer_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;used_issuer_name&gt;</span>
</pre></div>
</div>
<p>If a user lost his second authentication factor he can’t ask for a new one, to reset it the administrator
should uncheck the ‘The user changed his password’ field on the user in the admin interface.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For security reasons, basic authentication and two factor authentication should not be enabled together.</p>
</div>
</div>
<div class="section" id="account-lockout">
<h2>Account lockout<a class="headerlink" href="#account-lockout" title="Permalink to this headline">¶</a></h2>
<p>To lock an account after a certain number of authentication failures, set the following settings:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars</span><span class="p">:</span>
  <span class="nt">authentication</span><span class="p">:</span>
    <span class="nt">max_consecutive_failures</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
<p>To unlock a user, the administrator should uncheck the ‘Deactivated’ field on the user in the
admin interface.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">c2cgeoportal</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=camptocamp&repo=c2cgeoportal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../administrator/index.html">Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Integrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2019, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/integrator/authentication.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>