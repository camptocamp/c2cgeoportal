
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HTTPS &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/c2c.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="https">
<h1>HTTPS<a class="headerlink" href="#https" title="Permalink to this headline">¶</a></h1>
<p>If your application is accessed in HTTPS, you have to make sure that all URLs
generated by the application (CSS and JavaScript files, images, MapServer
requests, etc.) use the HTTPS scheme as well. Otherwise the browser will
prompt “unsecure content” warnings.</p>
<p>There are two ways to manage this:</p>
<ul class="simple">
<li><p>application behind a proxy</p></li>
<li><p>application and SSL certificate on the same server</p></li>
</ul>
<section id="application-behind-a-proxy">
<h2>Application behind a proxy<a class="headerlink" href="#application-behind-a-proxy" title="Permalink to this headline">¶</a></h2>
<p>If the application is placed behind some proxy that removes the SSL encryption
(plain HTTP is used between the proxy and the server), then some specific
configuration is required both on the c2cgeoportal application and on the
proxy:</p>
<ul class="simple">
<li><p>The proxy should add a specific header to the requests. For example <code class="docutils literal notranslate"><span class="pre">X-Https</span>
<span class="pre">on</span></code> (<code class="docutils literal notranslate"><span class="pre">X-Https</span></code> is the header name, and <code class="docutils literal notranslate"><span class="pre">on</span></code> is the header value).</p></li>
</ul>
<p>In Mako templates, if you need to know what scheme is used, you may test the
value of <code class="docutils literal notranslate"><span class="pre">request.scheme</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">WMTS_OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
<span class="o">%</span> <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s1">&#39;https&#39;</span><span class="p">:</span>
    <span class="n">url</span><span class="p">:</span> <span class="s1">&#39;https://my.wmts.server/&#39;</span>
<span class="o">%</span> <span class="k">else</span><span class="p">:</span>
    <span class="n">url</span><span class="p">:</span> <span class="s1">&#39;https://my.wmts.server/&#39;</span>
<span class="o">%</span> <span class="n">endif</span>
<span class="o">/*</span> <span class="o">...</span> <span class="o">*/</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="application-and-ssl-certificate-on-the-same-server">
<h2>Application and SSL certificate on the same server<a class="headerlink" href="#application-and-ssl-certificate-on-the-same-server" title="Permalink to this headline">¶</a></h2>
<p>If the SSL certificate and the application are located on the same server, all
requests will be redirected to https. So you should change the scheme to https
for all url except for some cases that should always use http (typically,
all requests to localhost): see <em>url</em> parameter in tilegeneration configuration.</p>
<p>If you apply ssl encryption on your application, you should take care of the
tiles url to use https scheme to avoid mixing secure and insecure contents.</p>
<p>Finally, you should redirect all http requests to https. Depending on your
environment, you may need to request this via your infrastructure support.</p>
<p>In case you load http external resources into your application, you should use
the resourceproxy service as described below.</p>
</section>
<section id="loading-non-https-external-resources">
<h2>Loading non https external resources<a class="headerlink" href="#loading-non-https-external-resources" title="Permalink to this headline">¶</a></h2>
<p>If you want to load non https external resources in your https application, you
should use the <code class="docutils literal notranslate"><span class="pre">resourceproxy</span></code> service and add the list of hosts you want to access in your project
<cite>vars.yaml</cite> configuration file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resourceproxy</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># list of urls from which it is safe to load content</span><span class="w"></span>
<span class="w">    </span><span class="nt">targets</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="c1">#exampletargetname: https://www.camptocamp.com/?param1=%s&amp;param2=%s</span><span class="w"></span>
<span class="w">      </span><span class="nt">rfinfo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.rfinfo.vd.ch/rfinfo.php?no_commune=%s&amp;no_immeuble=%s</span><span class="w"></span>
</pre></div>
</div>
<p>Then you can access resources by building urls using the following schema:
<code class="docutils literal notranslate"><span class="pre">https://&lt;host&gt;/resourceproxy?target=&lt;targetname&gt;&amp;values=(&lt;valueparam1&gt;,...)</span></code>.</p>
<p>For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">https://geoportail.camptocamp.com/main/resourceproxy?target=rfinfo&amp;values=(175,2633)</span></code></p>
</section>
<section id="local-certificate-checks">
<h2>Local certificate checks<a class="headerlink" href="#local-certificate-checks" title="Permalink to this headline">¶</a></h2>
<p>Certain c2cgeoportal features open a http session to your c2cgeoportal services,
for example the <code class="docutils literal notranslate"><span class="pre">checker</span></code> or the <code class="docutils literal notranslate"><span class="pre">lingua_extractor</span></code>.
If you are running your server in https and wish to disable certificate checks in these
connections, you can achieve this by adding the following configuration element to your <code class="docutils literal notranslate"><span class="pre">vars</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">http_options</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w"></span>
</pre></div>
</div>
<p>See other options in parameters of
<a class="reference external" href="https://docs.python-requests.org/en/latest/api.html#requests.Request">requests.Request</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">c2cgeoportal</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=camptocamp&repo=c2cgeoportal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../administrator/index.html">Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Integrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2021, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/integrator/https.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>