
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Create a new application &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/c2c.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Install an existing application" href="install_application.html" />
    <link rel="prev" title="Requirements" href="requirements.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="create-a-new-application">
<span id="integrator-create-application"></span><h1>Create a new application<a class="headerlink" href="#create-a-new-application" title="Permalink to this heading">¶</a></h1>
<p>Creating a new c2cgeoportal application is done by applying two Cookiecutter scaffolds
(a.k.a. templates and scaffolds). These scaffolds are provided by the
<code class="docutils literal notranslate"><span class="pre">c2cgeoportal</span></code> package. So to be able to create a c2cgeoportal application
the <code class="docutils literal notranslate"><span class="pre">c2cgeoportal</span></code> package must be installed.</p>
<section id="project-structure">
<h2>Project structure<a class="headerlink" href="#project-structure" title="Permalink to this heading">¶</a></h2>
<p>In the simple case, the root directory of the application is the directory
created by the c2cgeoportal scaffolds (the <code class="docutils literal notranslate"><span class="pre">c2cgeoportal_create</span></code> and
<code class="docutils literal notranslate"><span class="pre">c2cgeoportal_update</span></code> scaffolds).</p>
</section>
<section id="set-environment-variables">
<h2>Set environment variables<a class="headerlink" href="#set-environment-variables" title="Permalink to this heading">¶</a></h2>
<p>For this procedure, we need to set some environment variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1"><span class="nv">GEOMAPFISH_VERSION</span><span class="o">=</span>&lt;release&gt;</span>
<span class="prompt1"><span class="nv">GEOMAPFISH_PROJECT</span><span class="o">=</span>&lt;project&gt;</span>
<span class="prompt1"><span class="nv">GEOMAPFISH_PACKAGE</span><span class="o">=</span>&lt;package&gt;</span>
</pre></div></div><p>Where <code class="docutils literal notranslate"><span class="pre">&lt;release&gt;</span></code> can be found on <a class="reference external" href="https://hub.docker.com/r/camptocamp/geomapfish-tools/tags?name=2.9">Docker Hub</a>,
&lt;project&gt; is the project name that should be the GitHub repository name, &lt;package&gt; is the package name.</p>
</section>
<section id="list-existing-scaffolds">
<h2>List existing scaffolds<a class="headerlink" href="#list-existing-scaffolds" title="Permalink to this heading">¶</a></h2>
<p>To list the available scaffolds, use the following command, either
from the root directory of c2cgeoportal (if you have followed the instructions
from the previous section), or from the root directory of the existing
c2cgeoportal application you want to create the new application from:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>camptocamp/geomapfish-tools:<span class="si">${</span><span class="nv">GEOMAPFISH_VERSION</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pcreate<span class="w"> </span>-l</span>
</pre></div></div><p>You should at least see the c2cgeoportal scaffolds:</p>
<ul class="simple">
<li><p>c2cgeoportal_create</p></li>
<li><p>c2cgeoportal_update</p></li>
<li><p>c2cgeoportal_advance_create</p></li>
<li><p>c2cgeoportal_advance_update</p></li>
</ul>
</section>
<section id="create-the-new-application">
<h2>Create the new application<a class="headerlink" href="#create-the-new-application" title="Permalink to this heading">¶</a></h2>
<p>To create the application, first apply the <code class="docutils literal notranslate"><span class="pre">c2cgeoportal_create</span></code> scaffold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-ti<span class="w"> </span>--volume<span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>camptocamp/geomapfish-tools:<span class="si">${</span><span class="nv">GEOMAPFISH_VERSION</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>run<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span>/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pcreate<span class="w"> </span>--scaffold<span class="o">=</span>create<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span></span>
</pre></div></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not add any ‘/’ after the project name.</p>
</div>
<p>You will be asked to enter the SRID and the Apache vhost for this project. Note
that the default extent would be defined directly from the SRID. You can change
it later.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can define this information directly in the command line using
parameters:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-ti<span class="w"> </span>--volume<span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--env<span class="o">=</span><span class="nv">SRID</span><span class="o">=</span><span class="m">2056</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--env<span class="o">=</span><span class="nv">EXTENT</span><span class="o">=</span><span class="s2">&quot;2420000,1030000,2900000,1350000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>camptocamp/geomapfish-tools:<span class="si">${</span><span class="nv">GEOMAPFISH_VERSION</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>run<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span>/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pcreate<span class="w"> </span>--scaffold<span class="o">=</span>create<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--package-name<span class="o">=</span><span class="si">${</span><span class="nv">GEOMAPFISH_PACKAGE</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span></span>
</pre></div></div></div></blockquote>
</div>
<p>This will create a directory named <code class="docutils literal notranslate"><span class="pre">&lt;project&gt;</span></code> in you current directory.</p>
<p>For an advance application, apply the <code class="docutils literal notranslate"><span class="pre">c2cgeoportal_advance_create</span></code> scaffold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-ti<span class="w"> </span>--volume<span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>camptocamp/geomapfish-tools:<span class="si">${</span><span class="nv">GEOMAPFISH_VERSION</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>run<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span>/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pcreate<span class="w"> </span>--scaffold<span class="o">=</span>advance_create<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span><span class="w"> </span>--overwrite</span>
</pre></div></div><p>Now apply the <code class="docutils literal notranslate"><span class="pre">c2cgeoportal_update</span></code> scaffold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-ti<span class="w"> </span>--volume<span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>camptocamp/geomapfish-tools:<span class="si">${</span><span class="nv">GEOMAPFISH_VERSION</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>run<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span>/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pcreate<span class="w"> </span>--scaffold<span class="o">=</span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span><span class="w"> </span>--overwrite</span>
</pre></div></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not add any ‘/’ after the project name.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">c2cgeoportal_update</span></code> scaffold is also used to update the
application. The files generated by this scaffold are prefixed with
<code class="docutils literal notranslate"><span class="pre">CONST_</span></code>, which means they are <em>constant</em> files that should not be changed.
Following this rule is important for easier updates.</p>
<p>For an advance application apply the <code class="docutils literal notranslate"><span class="pre">c2cgeoportal_advance_update</span></code> scaffold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-ti<span class="w"> </span>--volume<span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>camptocamp/geomapfish-tools:<span class="si">${</span><span class="nv">GEOMAPFISH_VERSION</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>run<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span>/src<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pcreate<span class="w"> </span>-s<span class="w"> </span>advance_update<span class="w"> </span><span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span></span>
</pre></div></div><p>Go to your new project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span></span>
</pre></div></div><p>For advance application you also should:</p>
<p>Add an attribute <code class="docutils literal notranslate"><span class="pre">advance:</span> <span class="pre">true</span></code> in your <code class="docutils literal notranslate"><span class="pre">project.yaml</span></code> file.</p>
<dl class="simple">
<dt>In the <code class="docutils literal notranslate"><span class="pre">docker-compose.yaml</span></code> file in the service <code class="docutils literal notranslate"><span class="pre">geoportal</span></code> you should replace</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service:</span> <span class="pre">geoportal</span></code> by <code class="docutils literal notranslate"><span class="pre">service:</span> <span class="pre">geoportal-advance</span></code>, and in service <code class="docutils literal notranslate"><span class="pre">alembic</span></code> you should replace
<code class="docutils literal notranslate"><span class="pre">service:</span> <span class="pre">alembic</span></code> by <code class="docutils literal notranslate"><span class="pre">service:</span> <span class="pre">alembic-advance</span></code>.</p>
</dd>
</dl>
</section>
<section id="simple-application">
<h2>Simple application<a class="headerlink" href="#simple-application" title="Permalink to this heading">¶</a></h2>
<p>In contrast, a full application is an application for which the all possibilities for customization are
made available, a simple application is an application for which no custom code is needed
(Python or JavaScript).</p>
<p>See also <a class="reference internal" href="structure.html#integrator-structure"><span class="std std-ref">Project structure</span></a> for more information.</p>
<p>The documentation sections, in administrator and integrator guides, indicate whether the current
section applies to the simple application mode or not.</p>
<p>To convert an application to a simple application you should do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">git<span class="w"> </span>rm<span class="w"> </span>geoportal</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>geoportal/vars.yaml</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>geoportal/CONST_vars.yaml</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>geoportal/CONST_config-schema.yaml</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>geoportal/&lt;project&gt;_geoportal/locale/</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>geoportal/&lt;project&gt;_geoportal/static/</span>
<span class="prompt1">git<span class="w"> </span>rm<span class="w"> </span>CONST_create_template/geoportal</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>CONST_create_template/geoportal/vars.yaml</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>CONST_create_template/geoportal/CONST_vars.yaml</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>CONST_create_template/geoportal/CONST_config-schema.yaml</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>CONST_create_template/geoportal/&lt;project&gt;_geoportal/locale/</span>
<span class="prompt1">git<span class="w"> </span>checkout<span class="w"> </span>CONST_create_template/geoportal/&lt;project&gt;_geoportal/static/</span>
</pre></div></div><p>You should also set an API name, in the <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code> file, in <cite>vars/api/name`</cite> and also modify the
<code class="docutils literal notranslate"><span class="pre">geoportal/&lt;package&gt;_geoportal/static/apihelp/index.html</span></code> file.</p>
<p>Remove the attribute <code class="docutils literal notranslate"><span class="pre">advance:</span> <span class="pre">true</span></code> in your <code class="docutils literal notranslate"><span class="pre">project.yaml</span></code> file.</p>
</section>
<section id="put-the-application-under-revision-control">
<h2>Put the application under revision control<a class="headerlink" href="#put-the-application-under-revision-control" title="Permalink to this heading">¶</a></h2>
<p>Now is a good time to put the application source code under revision control.</p>
<section id="to-add-a-project-in-a-new-repository">
<h3>To add a project in a new repository<a class="headerlink" href="#to-add-a-project-in-a-new-repository" title="Permalink to this heading">¶</a></h3>
<p>Add the project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">git<span class="w"> </span>init</span>
<span class="prompt1">git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>git@github.com:camptocamp/<span class="si">${</span><span class="nv">GEOMAPFISH_PROJECT</span><span class="si">}</span>.git</span>
</pre></div></div><p>Commit and push on the main repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">git<span class="w"> </span>add<span class="w"> </span>.</span>
<span class="prompt1">git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Initial commit&quot;</span></span>
<span class="prompt1">git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>master</span>
</pre></div></div></section>
</section>
<section id="configuration-of-different-environments-in-your-project">
<h2>Configuration of different environments in your project<a class="headerlink" href="#configuration-of-different-environments-in-your-project" title="Permalink to this heading">¶</a></h2>
<section id="concepts">
<h3>Concepts<a class="headerlink" href="#concepts" title="Permalink to this heading">¶</a></h3>
<p>Application instances for different environments or for personal development should be configured through
environment variables that are defined in the <code class="docutils literal notranslate"><span class="pre">env</span></code> files (file with default value: <code class="docutils literal notranslate"><span class="pre">env.default</span></code>,
file with project values: <code class="docutils literal notranslate"><span class="pre">env.project</span></code>). Each environment can have its own <code class="docutils literal notranslate"><span class="pre">env</span></code> file (for example,
development, integration, production).</p>
<p>Whenever possible, it is strongly advised not to extend the <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code> file.
We recommend instead that you use dynamic variables as described below.
However, in some use cases extending <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code> may be needed:</p>
<ul class="simple">
<li><p>Configuring highly specific environments</p></li>
<li><p>Configuration of a multi-organization project</p></li>
</ul>
</section>
<section id="use-of-dynamic-variables">
<h3>Use of dynamic variables<a class="headerlink" href="#use-of-dynamic-variables" title="Permalink to this heading">¶</a></h3>
<p>Variables used in the application configuration files (files <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code>)
can be made dynamic by means of environment variable. For this, in the main file
<code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code>, add a block <code class="docutils literal notranslate"><span class="pre">runtime_environment</span></code> at the bottom of the file.</p>
<p>In this same file, you can change the value of a parameter by putting it in
uppercase (example: <code class="docutils literal notranslate"><span class="pre">host:</span> <span class="pre">'{HOST}'</span></code>). This parameter must be listed in the
interpreted parameters section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">extends</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CONST_vars.yaml</span>

<span class="nt">vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{HOST}&#39;</span>
<span class="nn">...</span>
<span class="nt">runtime_environment</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HOST</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">env.project</span></code> file, add parameters you want to change as exported variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HOST</span><span class="o">=</span><span class="n">domaine</span><span class="o">.</span><span class="n">different</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">env</span></code> file that extends this main file, you only need to define the environment variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HOST</span><span class="o">=</span><span class="n">prod</span><span class="o">.</span><span class="n">different</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</section>
</section>
<section id="configure-the-application">
<h2>Configure the application<a class="headerlink" href="#configure-the-application" title="Permalink to this heading">¶</a></h2>
<p>As the integrator, you need to edit the <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">env.project</span></code> files to configure the application.</p>
<p>Do not forget to add your changes to git:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">git<span class="w"> </span>add<span class="w"> </span>vars.yaml<span class="w"> </span>env.project</span>
<span class="prompt1">git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Configure the project&quot;</span></span>
<span class="prompt1">git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>master</span>
</pre></div></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using a multi-organization project, you should add all new children to
the parent site check_collector configuration.</p>
</div>
<p>After creation and minimal setup the application is ready to be installed.
Then follow the sections in the install application guide:</p>
<ul class="simple">
<li><p><a class="reference internal" href="install_application.html#integrator-install-application-setup-database"><span class="std std-ref">Set up the database</span></a>.</p></li>
<li><p><a class="reference internal" href="install_application.html#integrator-install-application-create-schema"><span class="std std-ref">Create the schemas</span></a>.</p></li>
<li><p><a class="reference internal" href="install_application.html#integrator-install-application-install-application"><span class="std std-ref">Install the application</span></a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want a default theme, you can run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>geoportal<span class="w"> </span>create-demo-theme</span>
</pre></div></div></div>
</section>
<section id="dynamic-configuration">
<h2>Dynamic configuration<a class="headerlink" href="#dynamic-configuration" title="Permalink to this heading">¶</a></h2>
<p>Several files are generated on runtime, their content depending on the variables you
have set as environment variables.</p>
<p>The files can have the extension <code class="docutils literal notranslate"><span class="pre">.tmpl</span></code> and it use bash syntax (<code class="docutils literal notranslate"><span class="pre">${VARIABLE}</span></code>).</p>
</section>
<section id="github-workflows">
<h2>GitHub workflows<a class="headerlink" href="#github-workflows" title="Permalink to this heading">¶</a></h2>
<p>With the application we have some predefined workflows.</p>
<section id="github-workflows-main-yaml">
<h3><cite>.github/workflows/main.yaml</cite><a class="headerlink" href="#github-workflows-main-yaml" title="Permalink to this heading">¶</a></h3>
<p>The workflow that will run on all your commits, it will:
- Run some code style checks on your code.
- Build you application.
- Run the acceptance tests (if configured).
- Publish the application on DockerHub.
- Trigger another workflow (on ArgoCD repository) to deploy you new application.</p>
</section>
<section id="github-workflows-rebuild-yaml">
<h3><cite>.github/workflows/rebuild.yaml</cite><a class="headerlink" href="#github-workflows-rebuild-yaml" title="Permalink to this heading">¶</a></h3>
<p>This workflow run on each night to rebuild the application with the new version of the base images.</p>
<p>Be careful, GitHub will read only the file present on the main branch.</p>
</section>
<section id="github-workflows-update-l10n-yaml">
<h3><cite>.github/workflows/update_l10n.yaml</cite><a class="headerlink" href="#github-workflows-update-l10n-yaml" title="Permalink to this heading">¶</a></h3>
<p>This workflow will query the <cite>locale.pot</cite> view, using <cite>PROJECT_PUBLIC_URL</cite> found in <cite>Makefile</cite>,
and open a pull request to update the localization files (<cite>.po</cite>) with current list of translatable strings.</p>
<p>Be careful, GitHub will read only the file present on the main branch.</p>
</section>
<section id="acceptance-tests">
<h3>Acceptance tests<a class="headerlink" href="#acceptance-tests" title="Permalink to this heading">¶</a></h3>
<p>To have some acceptance tests you need to have a minimal dump of your database in the repository,
it can be obtained with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">scripts/db-backup<span class="w"> </span>--arg<span class="o">=</span>--schema<span class="o">=</span>&lt;schema&gt;<span class="w"> </span>../dump.backup</span>
</pre></div></div><p>In the <cite>Makefile</cite> you should configure the dump file as <cite>DUMP_FILE</cite>, the <cite>db-restore</cite> call in <cite>acceptance-init</cite>
should probably also be updated.</p>
<p>In the file <cite>.github/workflows/main.yaml</cite> you should uncomment all the lines related to the
acceptance tests.</p>
<p>The acceptance tests will test that we didn’t have any service in error, test the response of some URL,
see in the file <cite>tests/test_app.py</cite>.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">c2cgeoportal</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=camptocamp&repo=c2cgeoportal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../administrator/index.html">Administrator Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Integrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Integrator Guide</a><ul>
      <li>Previous: <a href="requirements.html" title="previous chapter">Requirements</a></li>
      <li>Next: <a href="install_application.html" title="next chapter">Install an existing application</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2023, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/integrator/create_application.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>