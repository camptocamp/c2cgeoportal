
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Customise the application &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Security" href="security.html" />
    <link rel="prev" title="Configuring Windows tools required to connect to our servers" href="windows_tools.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="customise-the-application">
<span id="integrator-customise"></span><h1>Customise the application<a class="headerlink" href="#customise-the-application" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>The application can be customised in the following manners:</p>
<p><code class="docutils literal notranslate"><span class="pre">functionalities</span></code>, <code class="docutils literal notranslate"><span class="pre">UI</span> <span class="pre">metadata</span></code> and data model extensions.</p>
<p>The functionalities will be attached to the <code class="docutils literal notranslate"><span class="pre">role</span></code> and the <code class="docutils literal notranslate"><span class="pre">theme</span></code>,
and the UI metadata will be attached to all the elements of the theme.</p>
<p>They should be configured in the vars file, in the <code class="docutils literal notranslate"><span class="pre">admin_interface</span></code> /
<code class="docutils literal notranslate"><span class="pre">available_functionalities</span></code> or respectively <code class="docutils literal notranslate"><span class="pre">available_metadata</span></code>.</p>
<p>It is a list of object who have a <code class="docutils literal notranslate"><span class="pre">name</span></code> and a <code class="docutils literal notranslate"><span class="pre">type</span></code>.</p>
<p>The type can be:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">string</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">list</span></code> a list of strings</li>
<li><code class="docutils literal notranslate"><span class="pre">boolean</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">integer</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">float</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">json</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">date</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">time</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">datetime</span></code> <a class="reference external" href="http://labix.org/python-dateutil#head-b95ce2094d189a89f80f5ae52a05b4ab7b41af47">see the python-dateutil documentation</a></li>
<li><code class="docutils literal notranslate"><span class="pre">url</span></code> see below</li>
</ul>
<p>Check <code class="docutils literal notranslate"><span class="pre">CONST_vars.yaml</span></code> for examples of usage.</p>
<p>In order to inherit the default values from <code class="docutils literal notranslate"><span class="pre">CONST_vars.yaml</span></code> make sure the <code class="docutils literal notranslate"><span class="pre">update_paths</span></code> section contains
the item <code class="docutils literal notranslate"><span class="pre">admin_interface.available_functionnalities</span></code> or respectively <code class="docutils literal notranslate"><span class="pre">admin_interface.available_metadata</span></code>.</p>
<div class="section" id="url">
<h2>URL<a class="headerlink" href="#url" title="Permalink to this headline">¶</a></h2>
<p>In the admin interface we can use in all the URLs the following special schema:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">static</span></code>: to use a static route,</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">static:///icon.png</span></code> will get the URL of the <code class="docutils literal notranslate"><span class="pre">static-ngeo</span></code> static route of the project.</li>
<li><code class="docutils literal notranslate"><span class="pre">static://static-cgxp/icon.png</span></code> will get the URL of the <code class="docutils literal notranslate"><span class="pre">static-cgxp</span></code> static route of the project.</li>
<li><code class="docutils literal notranslate"><span class="pre">static://prj:img/icon.png</span></code> will get the URL of the <code class="docutils literal notranslate"><span class="pre">img</span></code> static route of <code class="docutils literal notranslate"><span class="pre">prj</span></code>.</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">config</span></code>: to get the server name from the URL, with the config from the <code class="docutils literal notranslate"><span class="pre">vars</span></code> file:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">servers</span><span class="p">:</span>
   <span class="n">my_server</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">test</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">config://my_server/icon.png</span></code> will be transformed into
the URL <code class="docutils literal notranslate"><span class="pre">http://example.com/test/icon.png</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="functionalities">
<h2>Functionalities<a class="headerlink" href="#functionalities" title="Permalink to this headline">¶</a></h2>
<p>c2cgeoportal provides the concept of <em>functionality</em> that can be used to customize
the application according to the user’s permissions.</p>
<p>A functionality may be associated to users through different ways:</p>
<ol class="arabic simple">
<li>Functionalities for anonymous users are defined through the
<code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code> variable in the <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code>
configuration file.</li>
<li>Functionalities for authenticated users are defined through the
<code class="docutils literal notranslate"><span class="pre">functionalities:registered</span></code> variable in the <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code>
configuration file.</li>
<li>Functionalities for specific roles are defined in the database through the
administration interface.</li>
<li>Functionalities for specific users are defined in the database through the
administration interface.</li>
</ol>
<p>Each level overrides the previous ones in the same order as indicated above.
For example, if the user is authenticated and has associated functionalities in
the <code class="docutils literal notranslate"><span class="pre">user</span></code> database table, then the <code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code> and
<code class="docutils literal notranslate"><span class="pre">functionalities:registered</span></code> configuration variables, as well as any
functionality associated with his/her role, will be ignored.</p>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> file includes variables for managing <em>functionalities</em>.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">admin_interface</span></code>/<code class="docutils literal notranslate"><span class="pre">available_functionalities</span></code></dt>
<dd><p class="first">List of functionality types that should be available in the
administration interface (and added to the <code class="docutils literal notranslate"><span class="pre">functionality</span></code> table in the
database).</p>
<p>For example:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">admin_interface</span><span class="p">:</span>
    <span class="n">available_functionalities</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">default_basemap</span>
    <span class="o">-</span> <span class="n">print_template</span>
    <span class="o">-</span> <span class="n">mapserver_substitution</span>
</pre></div>
</div>
<p>The following syntax is also accepted:</p>
<div class="code yaml last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">admin_interface</span><span class="p">:</span>
    <span class="n">available_functionalities</span><span class="p">:</span> <span class="p">[</span><span class="n">default_basemap</span><span class="p">,</span> <span class="n">print_template</span><span class="p">,</span> <span class="n">mapserver_substitution</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code></dt>
<dd><p class="first">Functionalities accessible to anonymous users. This is a list of
key/value pairs, whose values are either arrays or scalars.</p>
<p>For example:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="n">print_template</span><span class="p">:</span>
        <span class="o">-</span> <span class="mi">1</span> <span class="n">A4</span> <span class="n">portrait</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="n">A3</span> <span class="n">landscape</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="n">plan</span>
</pre></div>
</div>
<p class="last">In this example anonymous users can print maps using the <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">A4</span> <span class="pre">portrait</span></code>
and <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">A3</span> <span class="pre">landscape</span></code> layouts only. And their default base layer is the
<code class="docutils literal notranslate"><span class="pre">plan</span></code> layer.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">functionalities:registered</span></code></dt>
<dd>Functionalities accessible to any authenticated user. This is a list of
key/value pairs, of the same form as for <code class="docutils literal notranslate"><span class="pre">functionalities:anonymous</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">functionalities:available_in_templates</span></code></dt>
<dd><p class="first">Functionalities that are made available to Mako templates (e.g.
<code class="docutils literal notranslate"><span class="pre">viewer.js</span></code>) through the <code class="docutils literal notranslate"><span class="pre">functionality</span></code> template variable.</p>
<p>For example with:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">available_in_templates</span><span class="p">:</span>
    <span class="o">-</span> <span class="o">&lt;</span><span class="n">functionality_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p class="last">if a user is associated to, say,
<code class="docutils literal notranslate"><span class="pre">&lt;functionality_name&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">value1</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;functionality_name&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">value2</span></code>,
then the <code class="docutils literal notranslate"><span class="pre">functionality</span></code> template variable will be set to a dict with one
key/value pair: <code class="docutils literal notranslate"><span class="pre">&quot;&lt;functionality_name&gt;&quot;:</span> <span class="pre">[&quot;value1&quot;,&quot;value2&quot;]</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="usage-in-templates">
<h3>Usage in Templates<a class="headerlink" href="#usage-in-templates" title="Permalink to this headline">¶</a></h3>
<p>As explained in the configuration section above,
a functionality can be used in the Mako templates as long as it has been
enabled using the <code class="docutils literal notranslate"><span class="pre">functionalities:available_in_templates</span></code> parameter in the
<code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> configuration file.</p>
<p>Functionalities may be used in templates for various purposes. The examples
below explain how to set the default basemap and how to limit access to some
plugins according to the user’s permissions.</p>
<div class="section" id="example-of-the-default-basemap-functionality">
<h4>Example of the default_basemap Functionality<a class="headerlink" href="#example-of-the-default-basemap-functionality" title="Permalink to this headline">¶</a></h4>
<p>Using functionalities, it is easy to set the default basemap that will be
displayed when a user loads the application depending on whether he/she is
anonymous, authenticated or has some specific role.</p>
<p>First make sure that <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> is made available in the templates
using the <code class="docutils literal notranslate"><span class="pre">functionalities:available_in_templates</span></code> parameter in the
<code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> configuration file:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">available_in_templates</span><span class="p">:</span> <span class="p">[</span><span class="n">default_basemap</span><span class="p">]</span>
</pre></div>
</div>
<p>Then indicate (still in <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code>) what default basemap should be used
for anonymous users:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="c1"># some other configs...</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">some_basemap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Optionally you may also indicate what basemap to use for authenticated users
(if omitted, the anonymous <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> value will be used):</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionalities</span><span class="p">:</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="c1"># ...</span>
    <span class="n">registered</span><span class="p">:</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">some_other_basemap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Finally you may link <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> functionalities to some roles or
users in the administration interface.</p>
<p>So that the <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> is actually provided to the
<code class="docutils literal notranslate"><span class="pre">cgxp_mapopacityslider</span></code> plugin, use the following configuration in your
project’s <code class="docutils literal notranslate"><span class="pre">viewer.js</span></code> template:</p>
<div class="code javascript highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="n">ptype</span><span class="p">:</span> <span class="s2">&quot;cgxp_mapopacityslider&quot;</span><span class="p">,</span>
    <span class="n">defaultBaseLayerRef</span><span class="p">:</span> <span class="s2">&quot;${functionality[&#39;default_basemap&#39;][0] | n}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="limiting-access-to-some-cgxp-plugins-using-functionalities">
<h4>Limiting Access to some CGXP Plugins using Functionalities<a class="headerlink" href="#limiting-access-to-some-cgxp-plugins-using-functionalities" title="Permalink to this headline">¶</a></h4>
<p>Functionalities may also be used to enable some CGXP plugins only for users
with specific roles.</p>
<p>To do so, add <code class="docutils literal notranslate"><span class="pre">authorized_plugins</span></code> to the list of functionalities that must be
available in the administration interface and to the list of functionalities
provided to the templates. Set also <code class="docutils literal notranslate"><span class="pre">authorized_plugins</span></code> as an empty list for
anonymous users. In <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code>:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">admin_interface</span><span class="p">:</span>
    <span class="c1"># ...</span>
    <span class="n">available_functionalities</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">default_basemap</span>
        <span class="o">-</span> <span class="n">print_template</span>
        <span class="o">-</span> <span class="n">mapserver_substitution</span>
        <span class="o">-</span> <span class="n">authorized_plugins</span>

<span class="n">functionalities</span><span class="p">:</span>
    <span class="c1"># ...</span>
    <span class="n">anonymous</span><span class="p">:</span>
        <span class="c1"># ...</span>
        <span class="n">default_basemap</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">some_basemap</span><span class="o">&gt;</span>
        <span class="n">authorized_plugins</span><span class="p">:</span> <span class="p">[]</span>

    <span class="n">available_in_templates</span><span class="p">:</span> <span class="p">[</span><span class="n">default_basemap</span><span class="p">,</span> <span class="n">authorized_plugins</span><span class="p">]</span>
</pre></div>
</div>
<p>Then you may test in your project’s <code class="docutils literal notranslate"><span class="pre">viewer.js</span></code> template if the current user
has been granted access to some protected plugins:</p>
<div class="code javascript highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">new</span> <span class="n">gxp</span><span class="o">.</span><span class="n">Viewer</span><span class="p">({</span>
    <span class="o">//</span> <span class="o">...</span>
    <span class="n">tools</span><span class="p">:</span> <span class="p">[{</span>
        <span class="o">//...</span>
    <span class="p">},</span>
    <span class="o">%</span> <span class="k">if</span> <span class="s1">&#39;&lt;some_protected_plugin&gt;&#39;</span> <span class="ow">in</span> <span class="n">functionality</span><span class="p">[</span><span class="s1">&#39;authorized_plugins&#39;</span><span class="p">]:</span>
    <span class="p">{</span>
        <span class="n">ptype</span><span class="p">:</span> <span class="o">...</span>
        <span class="o">//...</span>
    <span class="p">},</span>
    <span class="o">%</span> <span class="n">endif</span>
    <span class="p">{</span>
        <span class="o">//...</span>
    <span class="p">}]</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="using-functionalities-list-to-configure-the-layers-in-the-querybuilder">
<h4>Using Functionalities list to configure the layers in the QueryBuilder<a class="headerlink" href="#using-functionalities-list-to-configure-the-layers-in-the-querybuilder" title="Permalink to this headline">¶</a></h4>
<p>Add the new <code class="docutils literal notranslate"><span class="pre">querybuilder_layer</span></code> functionality to the list of
<code class="docutils literal notranslate"><span class="pre">available_functionalities</span></code> in your <code class="docutils literal notranslate"><span class="pre">vars_&lt;project&gt;.yaml</span></code> file:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">admin_interface</span><span class="p">:</span>
    <span class="n">available_functionalities</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="o">-</span> <span class="n">querybuilder_layer</span>
</pre></div>
</div>
<p>Make sure that the <code class="docutils literal notranslate"><span class="pre">dumps</span></code> function is imported in
<code class="docutils literal notranslate"><span class="pre">&lt;package&gt;/templates/viewer.js</span></code> using:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;%</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="k">import</span> <span class="n">dumps</span>
<span class="o">%&gt;</span>
</pre></div>
</div>
<p>And configure your plugin like that:</p>
<div class="code javascript highlight-default notranslate"><div class="highlight"><pre><span></span>{
    ptype: &quot;cgxp_querier&quot;,
    featureTypes: ${dumps(functionality[&#39;querybuilder_layer&#39;]) | n},
    ...
}
</pre></div>
</div>
<p>This way you may assign more than one layer per role using functionalities.</p>
</div>
<div class="section" id="using-functionalities-to-configure-the-basemap-to-use-for-each-theme">
<h4>Using Functionalities to configure the basemap to use for each theme<a class="headerlink" href="#using-functionalities-to-configure-the-basemap-to-use-for-each-theme" title="Permalink to this headline">¶</a></h4>
<p>A default basemap may be automatically loaded when the user selects a given
theme.</p>
<p>To do so make sure that the <code class="docutils literal notranslate"><span class="pre">MapOpacitySlider</span></code> plugin has a reference to the
layertree plugin. For instance:</p>
<div class="code javascript highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="n">ptype</span><span class="p">:</span> <span class="s2">&quot;cgxp_mapopacityslider&quot;</span><span class="p">,</span>
    <span class="n">layerTreeId</span><span class="p">:</span> <span class="s2">&quot;layertree&quot;</span><span class="p">,</span>
    <span class="n">defaultBaseLayerRef</span><span class="p">:</span> <span class="s2">&quot;${functionality[&#39;default_basemap&#39;][0] | n}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, in the administration interface, if not available yet, define a
<code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> functionality containing the basemap reference. Edit the
theme and select the basemap to load in the <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> list. If
several <code class="docutils literal notranslate"><span class="pre">default_basemap</span></code> items are selected, only the first one will be
taken into account.</p>
</div>
</div>
</div>
<div class="section" id="extend-the-data-model">
<h2>Extend the data model<a class="headerlink" href="#extend-the-data-model" title="Permalink to this headline">¶</a></h2>
<p>The Data model can be extended in the file <code class="docutils literal notranslate"><span class="pre">&lt;package&gt;/models.py</span></code>
and the corresponding admin interface configuration
in the file <code class="docutils literal notranslate"><span class="pre">&lt;package&gt;/forms.py</span></code>.</p>
<p>For example to add some user details, including a link to a
new class named “Title”, add to <code class="docutils literal notranslate"><span class="pre">&lt;package&gt;/models.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Used to hide the original user in the admin interface</span>
<span class="n">User</span><span class="o">.</span><span class="n">__acl__</span> <span class="o">=</span> <span class="p">[</span><span class="n">DENY_ALL</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">UserDetail</span><span class="p">(</span><span class="n">User</span><span class="p">):</span>
    <span class="n">__label__</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;userdetail&#39;</span><span class="p">)</span>
    <span class="n">__plural__</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;userdetails&#39;</span><span class="p">)</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;userdetail&#39;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="n">_schema</span><span class="p">}</span>
    <span class="n">__acl__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="n">ALL_PERMISSIONS</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">__mapper_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;polymorphic_identity&#39;</span><span class="p">:</span> <span class="s1">&#39;detailed&#39;</span><span class="p">}</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">_schema</span> <span class="o">+</span> <span class="s1">&#39;.user.id&#39;</span><span class="p">),</span>
            <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">phone</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">Unicode</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;phone&#39;</span><span class="p">))</span>

    <span class="c1"># title</span>
    <span class="n">title_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">_schema</span> <span class="o">+</span> <span class="s1">&#39;.title.id&#39;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="n">backref</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">functionalities</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">phone</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">User</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">functionalities</span><span class="p">,</span> <span class="n">role</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phone</span> <span class="o">=</span> <span class="n">phone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>

<span class="k">class</span> <span class="nc">Title</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__label__</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
    <span class="n">__plural__</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;titles&#39;</span><span class="p">)</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;title&#39;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;schema&#39;</span><span class="p">:</span> <span class="n">_schema</span><span class="p">}</span>
    <span class="n">__acl__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="n">ALL_PERMISSIONS</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">Unicode</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Name&#39;</span><span class="p">))</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">Unicode</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Description&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>

    <span class="k">def</span> <span class="nf">__unicode__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Customise the application</a><ul>
<li><a class="reference internal" href="#url">URL</a></li>
<li><a class="reference internal" href="#functionalities">Functionalities</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#usage-in-templates">Usage in Templates</a><ul>
<li><a class="reference internal" href="#example-of-the-default-basemap-functionality">Example of the default_basemap Functionality</a></li>
<li><a class="reference internal" href="#limiting-access-to-some-cgxp-plugins-using-functionalities">Limiting Access to some CGXP Plugins using Functionalities</a></li>
<li><a class="reference internal" href="#using-functionalities-list-to-configure-the-layers-in-the-querybuilder">Using Functionalities list to configure the layers in the QueryBuilder</a></li>
<li><a class="reference internal" href="#using-functionalities-to-configure-the-basemap-to-use-for-each-theme">Using Functionalities to configure the basemap to use for each theme</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#extend-the-data-model">Extend the data model</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Integrator Guide</a><ul>
      <li>Previous: <a href="windows_tools.html" title="previous chapter">Configuring Windows tools required to connect to our servers</a></li>
      <li>Next: <a href="security.html" title="next chapter">Security</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/integrator/customise.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2018, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/integrator/customise.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>