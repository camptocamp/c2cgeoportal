
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Headers &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/c2c.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configure the admin interface" href="admin_interface.html" />
    <link rel="prev" title="Working with Object storage (like S3)" href="objectstorage.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="headers">
<span id="integrator-headers"></span><h1>Headers<a class="headerlink" href="#headers" title="Permalink to this heading">¶</a></h1>
<section id="id1">
<h2>Headers<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">c2cgeoportal</span></code> adds some HTTP headers on its responses with certain default values.
You may wish to override the values being written. All this is done in the configuration with the
<code class="docutils literal notranslate"><span class="pre">headers</span></code> section in the vars file with the following syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span>vars:
  headers:
    &lt;view&gt;:
      cache_control_max_age: 600 # 10 minutes
      access_control_max_age: 600 # 10 minutes
      access_control_allow_origin: [] # list oh hosts (e.g. https://example.com) or &#39;*&#39;
      headers: {} @ list of additional headers
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;view&gt;</span></code> can be: <code class="docutils literal notranslate"><span class="pre">dynamic</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">api</span></code>, <code class="docutils literal notranslate"><span class="pre">apihelp</span></code>, <code class="docutils literal notranslate"><span class="pre">profile</span></code>, <code class="docutils literal notranslate"><span class="pre">raster</span></code>, <code class="docutils literal notranslate"><span class="pre">error</span></code>,
<code class="docutils literal notranslate"><span class="pre">themes</span></code>, <code class="docutils literal notranslate"><span class="pre">config</span></code>, <code class="docutils literal notranslate"><span class="pre">print</span></code>, <code class="docutils literal notranslate"><span class="pre">fulltextsearch</span></code>, <code class="docutils literal notranslate"><span class="pre">mapserver</span></code>, <code class="docutils literal notranslate"><span class="pre">tinyows</span></code>, <code class="docutils literal notranslate"><span class="pre">layers</span></code>,
<code class="docutils literal notranslate"><span class="pre">shortener</span></code>, <code class="docutils literal notranslate"><span class="pre">login</span></code>.</p>
</section>
<section id="content-security-policy">
<h2>Content-Security-Policy<a class="headerlink" href="#content-security-policy" title="Permalink to this heading">¶</a></h2>
<p>For the <code class="docutils literal notranslate"><span class="pre">Content-Security-Policy</span></code> header, <code class="docutils literal notranslate"><span class="pre">c2cgeoportal</span></code> includes specific variables in its standard
template, to facilitate the customization of these values.
The naming of these variables follows this pattern: <code class="docutils literal notranslate"><span class="pre">content_security_policy_&lt;path&gt;_&lt;directive&gt;[_extra]</span></code>.</p>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;path&gt;</span></code> can be: <code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">admin</span></code>, <code class="docutils literal notranslate"><span class="pre">apihelp</span></code> or <code class="docutils literal notranslate"><span class="pre">c2c</span></code>,
<code class="docutils literal notranslate"><span class="pre">&lt;directive&gt;</span></code> can be: <code class="docutils literal notranslate"><span class="pre">default_src</span></code>, <code class="docutils literal notranslate"><span class="pre">script_src</span></code>, <cite>style_src`</cite>, <code class="docutils literal notranslate"><span class="pre">img_src</span></code>,
<code class="docutils literal notranslate"><span class="pre">connect_src</span></code> or <code class="docutils literal notranslate"><span class="pre">worker_src</span></code>,
<code class="docutils literal notranslate"><span class="pre">[_extra]</span></code> is a suffix to be able to extend a directive instance of completely overriding it.</p>
</section>
<section id="access-control-allow-origin">
<h2>Access-Control-Allow-Origin<a class="headerlink" href="#access-control-allow-origin" title="Permalink to this heading">¶</a></h2>
<p>To add domain that can access to the authenticated routes you should have something like that
in the vars file:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="w"> </span> headers:<span class="w"></span>
<span class="w"> </span>   dynamic: &amp;header {}<span class="w"></span>
<span class="w"> </span>   index: *header<span class="w"></span>
<span class="w"> </span>   api: *header<span class="w"></span>
<span class="w"> </span>   apihelp: *header<span class="w"></span>
<span class="w"> </span>   profile: *header<span class="w"></span>
<span class="w"> </span>   raster: *header<span class="w"></span>
<span class="w"> </span>   error: *header<span class="w"></span>
<span class="gd">-   themes: &amp;auth_header {}</span><span class="w"></span>
<span class="gi">+   themes: &amp;auth_header</span><span class="w"></span>
<span class="gi">+     access_control_allow_origin:</span><span class="w"></span>
<span class="gi">+         - &quot;{VISIBLE_WEB_PROTOCOL}://{VISIBLE_WEB_HOST}&quot;</span><span class="w"></span>
<span class="gi">+         - &quot;https://your.custom.domain&quot;</span><span class="w"></span>
<span class="gi">+         - &quot;*&quot;</span><span class="w"></span>
<span class="w"> </span>   config: *auth_header<span class="w"></span>
<span class="w"> </span>   print: *auth_header<span class="w"></span>
<span class="w"> </span>   fulltextsearch: *auth_header<span class="w"></span>
<span class="w"> </span>   mapserver: *auth_header<span class="w"></span>
<span class="w"> </span>   tinyows: *auth_header<span class="w"></span>
<span class="w"> </span>   layers: *auth_header<span class="w"></span>
<span class="w"> </span>   shortener: *auth_header<span class="w"></span>
<span class="gd">-   login: *auth_header</span><span class="w"></span>
<span class="gi">+   login:</span><span class="w"></span>
<span class="gi">+     access_control_allow_origin:</span><span class="w"></span>
<span class="gi">+         - &quot;{VISIBLE_WEB_PROTOCOL}://{VISIBLE_WEB_HOST}&quot;</span><span class="w"></span>
<span class="gi">+         - &quot;https://your.custom.domain&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>Notes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">According</span> <span class="n">the</span> <span class="s1">&#39;Access-Control-Allow-Origin&#39;</span> <span class="n">standard</span><span class="p">,</span> <span class="n">when</span> <span class="n">we</span> <span class="n">specify</span> <span class="n">a</span> <span class="s1">&#39;*&#39;</span> <span class="n">the</span> <span class="n">browser</span> <span class="n">can</span> <span class="n">read</span> <span class="n">the</span>
<span class="n">content</span> <span class="kn">from</span> <span class="nn">all</span> <span class="n">origins</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">browser</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">send</span> <span class="n">the</span> <span class="n">credentials</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="global-headers">
<h2>Global headers<a class="headerlink" href="#global-headers" title="Permalink to this heading">¶</a></h2>
<p>For path the not manage with the <code class="docutils literal notranslate"><span class="pre">headers</span></code> section we can use the <code class="docutils literal notranslate"><span class="pre">global_headers</span></code> section
in the vars file with the following syntax:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">global_headers</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;regex&gt;</span><span class="w"></span>
<span class="w">      </span><span class="nt">headers</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">&lt;header&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;value&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>If a path matches more than one pattern, all headers listed in each match will be applied.
If the same header is matched more than once, the last value is kept.</p>
</section>
<section id="forward-host">
<h2>Forward host<a class="headerlink" href="#forward-host" title="Permalink to this heading">¶</a></h2>
<p>Requests passing through the c2cgeoportal proxy will have their host set with the host
of the server. It’s possible to keep the original host by adding the host value to preserve
in the <cite>host_forward_host</cite> array of strings.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">host_forward_host</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;host.one&gt;</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;host.two&gt;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="headers-whitelist-and-blacklist">
<h2>Headers whitelist and blacklist<a class="headerlink" href="#headers-whitelist-and-blacklist" title="Permalink to this heading">¶</a></h2>
<p>It’s possible to filter the headers of requests with a whitelist or a blacklist.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">vars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">headers_whitelist</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
<span class="w">  </span><span class="nt">headers_blacklist</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;header-one&gt;</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;header-two&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>The whitelist is applied before the blacklist.
These lists are applied on each request passing through the c2cgeoportal proxy.
Pyramid will still add back its default headers.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">c2cgeoportal</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=camptocamp&repo=c2cgeoportal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../administrator/index.html">Administrator Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Integrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Integrator Guide</a><ul>
  <li><a href="configuration.html">Configuration Guide for advanced settings</a><ul>
      <li>Previous: <a href="objectstorage.html" title="previous chapter">Working with Object storage (like S3)</a></li>
      <li>Next: <a href="admin_interface.html" title="next chapter">Configure the admin interface</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2022, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/integrator/headers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/camptocamp/c2cgeoportal" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>