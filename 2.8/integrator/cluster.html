
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Create a cluster &#8212; c2cgeoportal  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/c2c.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Filter (Querier)" href="filter.html" />
    <link rel="prev" title="Caching" href="caching.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="create-a-cluster">
<span id="integrator-cluster"></span><h1>Create a cluster<a class="headerlink" href="#create-a-cluster" title="Permalink to this heading">Â¶</a></h1>
<p>A cluster is a configuration where several servers are used to serve the application.</p>
<p>Deploying data from integration to production may be done by
<a class="reference external" href="https://wiki.postgresql.org/wiki/Clone_schema">cloning the main integration schema</a>;
a customized version of the script, applicable for c2cgeoportal, is available in
<code class="docutils literal notranslate"><span class="pre">scripts/CONST_clone_schema.sql</span></code>.</p>
<p>For the next steps, it is important to know if your main goal is the scalability
or the robustness of the application.</p>
<p>In general, scalability is more important, because the main cause of
down time is too much traffic.</p>
<p>To have better DB performance, one can setup multiple Postgres servers in a
<a class="reference external" href="https://wiki.postgresql.org/wiki/Binary_Replication_Tutorial">master/slave</a>
configuration. To enable this feature on GeoMapFish, you must add this to your <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dbhost_slave</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_db_slave_hostname</span>
</pre></div>
</div>
<p>Then, all the GET and OPTIONS requests will use one of the slave Postgres instances and the
rest will use the master instance.
It is assumed, here, that the views handling the GET and OPTIONS queries do not cause write
operations to the database (not supported by slave instances). If it is not the case in your
application (bad practice), add entries to <code class="docutils literal notranslate"><span class="pre">db_chooser/master</span></code> in your <code class="docutils literal notranslate"><span class="pre">vars.yaml</span></code>.
For forcing the use of a slave for a POST/PUT/DELETE, add entries to the <code class="docutils literal notranslate"><span class="pre">db_chooser/slave</span></code>
configuration.</p>
<p>To have more than one slave instance and to have an automatic election of a new
master in case of failure, you must setup a high availability proxy (HAProxy, for example).
This is out of the scope of this document. If you do not care about failover, you can use one
DNS entry with multiple IP entries for the slaves.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/camptocamp.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">c2cgeoportal</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=camptocamp&repo=c2cgeoportal&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../administrator/index.html">Administrator Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Integrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Integrator Guide</a><ul>
  <li><a href="configuration.html">Configuration Guide for advanced settings</a><ul>
      <li>Previous: <a href="caching.html" title="previous chapter">Caching</a></li>
      <li>Next: <a href="filter.html" title="next chapter">Filter (Querier)</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2011-2024, Camptocamp.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/integrator/cluster.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>